{
  "version": "7.0",
  "data_api_version": "3.0",

  "routing_model": {
    "WELCOME_SCREEN": ["CHOOSE_ORIGIN", "GENERIC_ERROR"],
    "CHOOSE_ORIGIN": ["CHOOSE_DESTINATION", "GENERIC_ERROR"],
    "CHOOSE_DESTINATION": ["CHOOSE_DATE", "GENERIC_ERROR"],
    "CHOOSE_DATE": ["CHOOSE_TIME", "GENERIC_ERROR"],
    "CHOOSE_TIME": ["SELECT_FILTERS", "GENERIC_ERROR"],
    "SELECT_FILTERS": ["DISPLAY_RESULTS", "GENERIC_ERROR"],
    "NO_DISPLAY_RESULTS": ["SELECT_FILTERS"],
    "DISPLAY_RESULTS": ["CHOOSE_SEAT", "NO_DISPLAY_RESULTS", "GENERIC_ERROR"],
    "CHOOSE_SEAT": ["PASSENGER_INFO", "GENERIC_ERROR"],
    "PASSENGER_INFO": ["SUMMARY", "GENERIC_ERROR"],
    "SUMMARY": ["TERMS", "GENERIC_ERROR"],
    "TERMS": ["GENERIC_ERROR"],
    "GENERIC_ERROR": []
  },

  "screens": [
    {
      "id": "WELCOME_SCREEN",
      "title": "Welcome to our Platform",
      "data": {
        "options": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "book_ticket", "title": "üéüÔ∏è Buy Bus Ticket" },
            { "id": "faq", "title": "‚ùì FAQs" },
            { "id": "support", "title": "üí¨ Chat with Support" }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "ChipsSelector",
            "name": "selected_option",
            "label": "What would you like to do?",
            "data-source": "${data.options}",
            "required": true,
            "max-selected-items": 1
          },
          {
            "type": "Footer",
            "label": "Continue",
            "on-click-action": {
              "name": "data_exchange",
              "payload": {
                "screen": "WELCOME_SCREEN",
                "selected_option": "${form.selected_option}"
              }
            }
          }
        ]
      }
    },

    {
      "id": "CHOOSE_ORIGIN",
      "title": "üöè Where are you leaving from?",
      "data": {
        "origins": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "yaounde", "title": "Yaounde" },
            { "id": "douala", "title": "Douala" },
            { "id": "buea", "title": "Buea" },
            { "id": "bamenda", "title": "Bamenda" }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "origin_form",
            "children": [
              {
                "type": "Dropdown",
                "label": "Origin city",
                "name": "origin",
                "data-source": "${data.origins}",
                "required": true
              },
              {
                "type": "Footer",
                "label": "Continue ‚Üí",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "screen": "CHOOSE_ORIGIN",
                    "origin": "${form.origin}"
                  }
                }
              }
            ]
          }
        ]
      }
    },

    {
      "id": "CHOOSE_DESTINATION",
      "title": "üìç Where are you headed?",
      "data": {
        "origin": {
          "type": "string",
          "__example__": "yaounde"
        },
        "origin_city_intro_text": {
          "type": "string",
          "__example__": "You selected Yaounde"
        },
        "destinations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "douala", "title": "Douala" },
            { "id": "buea", "title": "Buea" },
            { "id": "bamenda", "title": "Bamenda" }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "destination_form",
            "children": [
              {
                "type": "TextBody",
                "text": "${data.origin_city_intro_text}",
                "markdown": true
              },
              {
                "type": "Dropdown",
                "label": "Your destination",
                "name": "destination",
                "data-source": "${data.destinations}",
                "required": true
              },
              {
                "type": "Footer",
                "label": "Continue ‚Üí",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "screen": "CHOOSE_DESTINATION",
                    "origin": "${data.origin}",
                    "destination": "${form.destination}"
                  }
                }
              }
            ]
          }
        ]
      }
    },

    {
      "id": "CHOOSE_DATE",
      "title": "üìÖ Choose Your Travel Date",
      "data": {
        "origin": { "type": "string", "__example__": "yaounde" },
        "destination": { "type": "string", "__example__": "douala" },
        "today": { "type": "string", "__example__": "2025-06-05" },
        "max_date": { "type": "string", "__example__": "2025-07-05" },
        "date_intro": {
          "type": "string",
          "__example__": "You're traveling from Yaounde to Douala. When would you like to travel?"
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "${data.date_intro}",
            "markdown": true
          },
          {
            "type": "CalendarPicker",
            "label": "Choose a date",
            "name": "date",
            "min-date": "${data.today}",
            "max-date": "${data.max_date}",
            "init-value": "${data.today}",
            "required": true
          },
          {
            "type": "Footer",
            "label": "Continue ‚Üí",
            "on-click-action": {
              "name": "data_exchange",
              "payload": {
                "screen": "CHOOSE_DATE",
                "origin": "${data.origin}",
                "destination": "${data.destination}",
                "date": "${form.date}"
              }
            }
          }
        ]
      }
    },

    {
      "id": "CHOOSE_TIME",
      "title": "üïí Departure Time",
      "data": {
        "origin": { "type": "string", "__example__": "yaounde" },
        "destination": { "type": "string", "__example__": "douala" },
        "date": { "type": "string", "__example__": "2025-06-06" },

        "is_morning_selected": { "type": "boolean", "__example__": false },
        "is_afternoon_selected": { "type": "boolean", "__example__": false },
        "is_evening_selected": { "type": "boolean", "__example__": false },

        "morning_slots": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "08:00", "title": "08:00 AM" },
            { "id": "10:00", "title": "10:00 AM" }
          ]
        },
        "afternoon_slots": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "12:00", "title": "12:00 PM" },
            { "id": "15:00", "title": "03:00 PM" }
          ]
        },
        "evening_slots": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "18:00", "title": "06:00 PM" },
            { "id": "20:00", "title": "08:00 PM" }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "Pick time periods and specific hours. All optional."
          },
          {
            "type": "ChipsSelector",
            "name": "selected_periods",
            "label": "Time of Day",
            "data-source": [
              {
                "id": "morning",
                "title": "üåÖ Morning",
                "enabled": true,
                "on-select-action": {
                  "name": "update_data",
                  "payload": { "is_morning_selected": true }
                },
                "on-unselect-action": {
                  "name": "update_data",
                  "payload": { "is_morning_selected": false }
                }
              },
              {
                "id": "afternoon",
                "title": "üå§ Afternoon",
                "enabled": true,
                "on-select-action": {
                  "name": "update_data",
                  "payload": { "is_afternoon_selected": true }
                },
                "on-unselect-action": {
                  "name": "update_data",
                  "payload": { "is_afternoon_selected": false }
                }
              },
              {
                "id": "evening",
                "title": "üåô Evening",
                "enabled": true,
                "on-select-action": {
                  "name": "update_data",
                  "payload": { "is_evening_selected": true }
                },
                "on-unselect-action": {
                  "name": "update_data",
                  "payload": { "is_evening_selected": false }
                }
              }
            ]
          },

          {
            "type": "If",
            "condition": "${data.is_morning_selected}",
            "then": [
              {
                "type": "CheckboxGroup",
                "name": "selected_morning_times",
                "label": "üåÖ Morning Times",
                "data-source": "${data.morning_slots}"
              }
            ]
          },
          {
            "type": "If",
            "condition": "${data.is_afternoon_selected}",
            "then": [
              {
                "type": "CheckboxGroup",
                "name": "selected_afternoon_times",
                "label": "üå§ Afternoon Times",
                "data-source": "${data.afternoon_slots}"
              }
            ]
          },
          {
            "type": "If",
            "condition": "${data.is_evening_selected}",
            "then": [
              {
                "type": "CheckboxGroup",
                "name": "selected_evening_times",
                "label": "üåô Evening Times",
                "data-source": "${data.evening_slots}"
              }
            ]
          },

          {
            "type": "Footer",
            "label": "Continue ‚Üí",
            "on-click-action": {
              "name": "data_exchange",
              "payload": {
                "screen": "CHOOSE_TIME",
                "origin": "${data.origin}",
                "destination": "${data.destination}",
                "date": "${data.date}",
                "selected_morning_times": "${form.selected_morning_times}",
                "selected_afternoon_times": "${form.selected_afternoon_times}",
                "selected_evening_times": "${form.selected_evening_times}"
              }
            }
          }
        ]
      }
    },

    {
      "id": "SELECT_FILTERS",
      "title": "üéØ Narrow Your Search",
      "data": {
        "origin": { "type": "string", "__example__": "yaounde" },
        "destination": { "type": "string", "__example__": "douala" },
        "date": { "type": "string", "__example__": "2025-06-06" },
        "time": { "type": "string", "__example__": "08:00" },
        "class_options": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" },
              "enabled": { "type": "boolean" }
            }
          },
          "__example__": [
            { "id": "VIP", "title": "VIP", "enabled": true },
            { "id": "Regular", "title": "Regular", "enabled": true }
          ]
        },
        "agency_options": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" },
              "enabled": { "type": "boolean" }
            }
          },
          "__example__": [
            { "id": "United Express", "title": "United Express", "enabled": true },
            { "id": "Touristique", "title": "Touristique", "enabled": true },
            { "id": "Finexs Voyages", "title": "Finexs Voyages", "enabled": true }
          ]
        },
        "selected_classes": {
          "type": "array",
          "items": { "type": "string" },
          "__example__": []
        },
        "selected_times": {
          "type": "array",
          "items": { "type": "string" },
          "__example__": []
        },
        "selected_agencies": {
          "type": "array",
          "items": { "type": "string" },
          "__example__": []
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "‚ú≥Ô∏è What is your travel preference?"
          },
          {
            "type": "ChipsSelector",
            "name": "selected_classes",
            "label": "Choose Class(es)",
            "data-source": "${data.class_options}",
            "required": false
          },
          {
            "type": "TextBody",
            "text": "üöç Prefer a specific travel agency?"
          },
          {
            "type": "ChipsSelector",
            "name": "selected_agencies",
            "label": "Choose Agency(ies)",
            "data-source": "${data.agency_options}",
            "required": false
          },
          {
            "type": "Footer",
            "label": "See Results ‚Üí",
            "on-click-action": {
              "name": "data_exchange",
              "payload": {
                "screen": "DISPLAY_RESULTS",
                "origin": "${data.origin}",
                "destination": "${data.destination}",
                "date": "${data.date}",
                "time": "${data.time}",
                "selected_times": "${data.selected_times}",
                "selected_classes": "${form.selected_classes}",
                "selected_agencies": "${form.selected_agencies}"
              }
            }
          }
        ]
      }
    },

    {
      "id": "DISPLAY_RESULTS",
      "title": "üé´ Available Trips",
      "data": {
        "trips": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "main-content": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "metadata": { "type": "string" }
                }
              },
              "on-click-action": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "payload": {
                    "type": "object",
                    "properties": {
                      "screen": {"type":"string"},
                      "agency": { "type": "string" },
                      "origin": { "type": "string" },
                      "destination": { "type": "string" },
                      "class": { "type": "string" },
                      "time": { "type": "string" },
                      "price": { "type": "integer" }
                    }
                  }
                }
              }
            }
          },
          "__example__": [
            {
              "id": "trip_001",
              "main-content": {
                "title": "Men Travel - VIP",
                "metadata": "Yaounde ‚Üí Douala | 08:30 | 10,000F"
              },
              "on-click-action": {
                "name": "data_exchange",
                "payload": {
                  "screen": "CHOOSE_SEAT",
                  "agency": "Men Travel",
                  "origin": "yaounde",
                  "destination": "douala",
                  "class": "VIP",
                  "time": "08:30",
                  "price": 10000
                }
              }
            },
            {
              "id": "trip_002",
              "main-content": {
                "title": "United Express - Regular",
                "metadata": "Yaounde ‚Üí Buea | 09:00 | 8,000F"
              },
              "on-click-action": {
                "name": "data_exchange",
                "payload": {
                  "screen": "CHOOSE_SEAT",
                  "agency": "United Express",
                  "origin": "yaounde",
                  "destination": "buea",
                  "class": "Regular",
                  "time": "09:00",
                  "price": 8000
                }
              }
            }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "NavigationList",
            "name": "trips",
            "list-items": "${data.trips}"
          }
        ]
      }
    },

    {
      "id": "NO_DISPLAY_RESULTS",
      "title": "No Trips Found",
      "data": {
        "origin": { "type": "string", "__example__": "yaounde" },
        "destination": { "type": "string", "__example__": "buea" },
        "date": { "type": "string", "__example__": "2025-06-10" },
        "time": { "type": "string", "__example__": "08:30" },
        "summary_text": { "type": "string", "__example__": "-- No trips match your selection --" },
        "selected_classes": {
          "type": "array",
          "items": { "type": "string" },
          "__example__": ["VIP", "Regular"]
        },
        "selected_agencies": {
          "type": "array",
          "items": { "type": "string" },
          "__example__": ["Musango", "Men Travel"]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextHeading",
            "text": "No Available Trips"
          },
          {
            "type": "TextBody",
            "markdown": true,
            "text": "${data.summary_text}"
          },
          {
            "type": "Footer",
            "label": "üîÅ Try Again",
            "on-click-action": {
              "name": "navigate",
              "next": {
                "type": "screen",
                "name": "SELECT_FILTERS"
              },
              "payload": {
                "origin": "${data.origin}",
                "destination": "${data.destination}",
                "date": "${data.date}",
                "time": "${data.time}",
                "selected_times": "${data.selected_times}",
                "selected_classes": "${data.selected_classes}",
                "selected_agencies": "${data.selected_agencies}"
              }
            }
          }
        ]
      }
    },

    {
      "id": "CHOOSE_SEAT",
      "title": "Select Your Seat",
      "data": {
        "image": {
          "type": "string",
          "__example__": "iVBORw0KGgoAAAANSUhEUgAA"
        },
        "seats": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id":    { "type": "string" },
              "title": { "type": "string" }
            }
          },
          "__example__": [
            { "id": "A1", "title": "A1" },
            { "id": "B1", "title": "B1" },
            { "id": "C1", "title": "C1" },
            { "id": "A2", "title": "A2" },
            { "id": "B2", "title": "B2" },
            { "id": "C2", "title": "C2" },
            { "id": "A3", "title": "A3" },
            { "id": "B3", "title": "B3" },
            { "id": "A4", "title": "A4" },
            { "id": "B4", "title": "B4" }
          ]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Image",
            "src": "${data.image}",
            "width": 300,
            "height": 300
          },
          {
            "type": "Form",
            "name": "seat_form",
            "children": [
              {
                "type": "ChipsSelector",
                "name": "seat",
                "label": "Available Seats",
                "data-source": "${data.seats}",
                "required": true
              },
              {
                "type": "Footer",
                "label": "Next",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "screen": "CHOOSE_SEAT",
                    "origin": "${data.origin}",
                    "destination": "${data.destination}",
                    "date": "${data.date}",
                    "time": "${data.time}",
                    "class": "${data.class}",
                    "agency": "${data.agency}",
                    "seat": "${form.seat}"
                  }
                }
              }
            ]
          }
        ]
      }
    },

    {
      "id": "PASSENGER_INFO",
      "title": "üë§ Passenger Details",
      "data": {
        "origin": { "type": "string", "__example__": "Yaounde" },
        "destination": { "type": "string", "__example__": "Douala" },
        "date": { "type": "string", "__example__": "2025-06-10" },
        "time": { "type": "string", "__example__": "10:00" },
        "agency": { "type": "string", "__example__": "Men Travel" },
        "class": { "type": "string", "__example__": "VIP" },
        "seat": {
          "type": "array",
          "items": { "type": "string" },
          "__example__": ["A1", "A2"]
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "passenger_form",
            "children": [
              {
                "type": "TextInput",
                "label": "Full Name",
                "name": "full_name",
                "required": true
              },
              {
                "type": "TextInput",
                "label": "Email",
                "name": "email",
                "input-type": "email",
                "required": true
              },
              {
                "type": "TextInput",
                "label": "Phone Number",
                "name": "phone",
                "input-type": "phone",
                "required": true
              },
              {
                "type": "TextInput",
                "label": "Number of Tickets",
                "name": "num_tickets",
                "input-type": "number",
                "required": true
              },
              {
                "type": "TextInput",
                "label": "Extra Notes",
                "name": "more_details"
              },
              {
                "type": "Footer",
                "label": "Next ‚Üí",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "screen": "PASSENGER_INFO",
                    "origin": "${data.origin}",
                    "destination": "${data.destination}",
                    "date": "${data.date}",
                    "time": "${data.time}",
                    "agency": "${data.agency}",
                    "class": "${data.class}",
                    "seat": "${data.seat}",
                    "full_name": "${form.full_name}",
                    "email": "${form.email}",
                    "phone": "${form.phone}",
                    "num_tickets": "${form.num_tickets}",
                    "more_details": "${form.more_details}"
                  }
                }
              }
            ]
          }
        ]
      }
    },

    {
      "id": "SUMMARY",
      "title": "Booking Summary",
      "terminal": true,
      "data": {
        "summary_text": {
          "type": "string",
          "__example__": "Men Travel - VIP\nYaounde ‚Üí Douala on 2025-06-10 at 10:00\nSeat(s): A1, A2\nName: Jane Doe\nEmail: jane@example.com\nPhone: 5551234567\nTickets: 2"
        },
        "agency":      { "type": "string", "__example__": "Men Travel" },
        "class":       { "type": "string", "__example__": "VIP" },
        "destination": { "type": "string", "__example__": "Douala" },
        "date":        { "type": "string", "__example__": "2025-06-10" },
        "time":        { "type": "string", "__example__": "10:00" },
        "seat":        { "type": "array", "items": { "type": "string" }, "__example__": ["A1", "A2"] },
        "full_name":   { "type": "string", "__example__": "Jane Doe" },
        "email":       { "type": "string", "__example__": "jane@example.com" },
        "phone":       { "type": "string", "__example__": "5551234567" },
        "num_tickets": { "type": "string", "__example__": "2" }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "Form",
            "name": "summary_form",
            "children": [
              {
                "type": "TextHeading",
                "text": "Please Confirm Your Booking"
              },
              {
                "type": "TextBody",
                "text": "${data.summary_text}",
                "markdown": true
              },
              {
                "type": "OptIn",
                "name": "agree_terms",
                "label": "I agree to the terms and conditions",
                "required": true,
                "on-click-action": {
                  "name": "navigate",
                  "next": {
                    "type": "screen",
                    "name": "TERMS"
                  },
                  "payload": {}
                }
              },
              {
                "type": "Footer",
                "label": "Confirm Booking",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "screen": "SUMMARY",
                    "agency": "${data.agency}",
                    "class": "${data.class}",
                    "origin": "${data.origin}",
                    "destination": "${data.destination}",
                    "date": "${data.date}",
                    "time": "${data.time}",
                    "seat": "${data.seat}",
                    "full_name": "${data.full_name}",
                    "email": "${data.email}",
                    "phone": "${data.phone}",
                    "num_tickets": "${data.num_tickets}",
                    "agree_terms": "${form.agree_terms}"
                  }
                }
              }
            ]
          }
        ]
      }
    },

    {
      "id": "TERMS",
      "title": "Terms & Conditions",
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextHeading",
            "text": "Terms & Conditions"
          },
          {
            "type": "TextBody",
            "text": "By confirming, you agree to our bus ticketing terms and conditions. Please ensure you arrive 15 minutes before departure time. Tickets are non-refundable.",
            "markdown": true
          }
        ]
      }
    },
    {
      "id": "GENERIC_ERROR",
      "title": "Oops!",
      "data": {
        "error_message": {
          "type": "string",
          "__example__": "Something went wrong..."
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "${data.error_message}"
          },
          {
            "type": "Footer",
            "label": "üèÅ Start Over",
            "on-click-action": {
              "name": "navigate",
              "next": {
                "type": "screen",
                "name": "WELCOME_SCREEN"
              },
              "payload": {}
            }
          }
        ]
      }
    }
  ]
}
